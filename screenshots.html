<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quynah UI Screenshots</title>
    <meta name="description" content="Browse Quynah UI screenshots across dashboards, evidence viewers, automations, and Workspace coverage." />
    <link rel="icon" type="image/png" href="assets/logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/photoswipe@5/dist/photoswipe.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo-wrapper">
                    <img src="assets/logo.png" alt="Quynah Logo" class="logo">
                    <span class="logo-text">Quynah</span>
                </div>
                <nav class="nav">
                    <a href="index.html#home" class="nav-link">Home</a>
                    <a href="index.html#features" class="nav-link">Features</a>
                    <a href="index.html#pipeline" class="nav-link">Pipeline</a>
                    <a href="index.html#multitenant" class="nav-link">Multi-Tenant</a>
                    <a href="screenshots.html" class="nav-link">Screenshots</a>
                    <a href="mailto:david@quynah.com" class="nav-link contact-link">Contact</a>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero hero-compact">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Quynah UI Screenshots</h1>
                <p class="hero-subtitle">Explore dashboards, evidence viewers, automations, and Workspace coverage views from the Quynah security platform.</p>
                <div class="hero-buttons">
                    <a href="index.html" class="btn btn-secondary">Back to Site</a>
                    <a href="mailto:david@quynah.com" class="btn btn-primary">Book a Walkthrough</a>
                </div>
            </div>
        </div>
    </section>

    <section class="section section-alt">
        <div class="container">
            <h2 class="section-title">Gallery</h2>
            <p class="section-subtitle">Screenshots are organized exactly like the product navigation. Click any thumbnail to open the lightbox and browse within its section.</p>

            <div id="gallery-status" class="gallery-status">Loading screenshots…</div>
            <div id="gallery-sections" class="gallery-sections" hidden></div>
        </div>
    </section>

    <script src="assets/screenshots-manifest.js"></script>
    <script type="module">
        import PhotoSwipeLightbox from 'https://unpkg.com/photoswipe@5/dist/photoswipe-lightbox.esm.js';

        const statusEl = document.getElementById('gallery-status');
        const sectionsEl = document.getElementById('gallery-sections');

        const setStatus = (message) => {
            statusEl.textContent = message;
            statusEl.hidden = false;
            sectionsEl.hidden = true;
        };

        const humanize = (text = '') => {
            const cleaned = text
                .replace(/^\d+\s*[.-]?\s*/, '') // strip leading numbering like "01 " or "01-"
                .replace(/[-_]+/g, ' ')
                .replace(/\s+/g, ' ')
                .trim();
            if (!cleaned) return '';
            return cleaned.charAt(0).toUpperCase() + cleaned.slice(1);
        };

        const slugify = (text = '') => text.toLowerCase()
            .replace(/[^a-z0-9]+/g, '-')
            .replace(/(^-|-$)/g, '') || 'gallery';

        const encodePath = (value = '') => encodeURI(value.replace(/\\/g, '/'));

        const buildCard = (image, galleryId, blockTitle) => {
            const figure = document.createElement('figure');
            figure.className = 'screenshot-card';

            const link = document.createElement('a');
            link.className = 'screenshot-link';
            link.href = encodePath(image.src || '');
            link.setAttribute('data-pswp', 'true');
            link.dataset.galleryId = galleryId;
            link.dataset.pswpSrc = encodePath(image.src || '');
            link.dataset.pswpWidth = '1600';
            link.dataset.pswpHeight = '900';

            const img = document.createElement('img');
            img.className = 'screenshot-img';
            img.loading = 'lazy';
            img.decoding = 'async';
            img.src = encodePath(image.src || '');
            img.alt = humanize(image.filename?.replace(/\.[^.]+$/, '')) || blockTitle || 'Screenshot';
            img.addEventListener('load', () => {
                if (img.naturalWidth && img.naturalHeight) {
                    link.dataset.pswpWidth = img.naturalWidth;
                    link.dataset.pswpHeight = img.naturalHeight;
                }
            });

            const caption = document.createElement('figcaption');
            caption.className = 'screenshot-caption';
            caption.textContent = img.alt;

            link.appendChild(img);
            figure.appendChild(link);
            figure.appendChild(caption);
            return figure;
        };

        const renderSections = (manifest) => {
            if (!Array.isArray(manifest) || manifest.length === 0) {
                setStatus('No screenshots found. Make sure the assets/New Screenshots Quynah UI folder is populated.');
                return;
            }

            sectionsEl.innerHTML = '';
            const grouped = new Map();

            manifest.forEach((section) => {
                const titles = Array.isArray(section.titles) ? section.titles : [];
                const top = titles[0];
                if (!top) return;
                if (!grouped.has(top)) grouped.set(top, []);
                grouped.get(top).push(section);
            });

            grouped.forEach((blocks, topTitle) => {
                const sectionEl = document.createElement('section');
                sectionEl.className = 'gallery-section';

                const sectionTitle = document.createElement('h3');
                sectionTitle.className = 'gallery-section-title';
                sectionTitle.textContent = humanize(topTitle);
                sectionEl.appendChild(sectionTitle);

                blocks.forEach((block) => {
                    if (!block.images || block.images.length === 0) return;

                    const blockEl = document.createElement('div');
                    blockEl.className = 'gallery-block';

                    const blockPath = Array.isArray(block.titles) ? block.titles : [];
                    const blockTitleText = (blockPath.slice(1).map(humanize).join(' / ')) || humanize(topTitle);

                    const blockTitleEl = document.createElement('h4');
                    blockTitleEl.className = 'gallery-block-title';
                    blockTitleEl.textContent = blockTitleText;

                    const breadcrumbEl = document.createElement('p');
                    breadcrumbEl.className = 'gallery-breadcrumb';
                    breadcrumbEl.textContent = blockPath.map(humanize).join(' / ');

                    const grid = document.createElement('div');
                    grid.className = 'gallery-grid';
                    grid.dataset.sectionPath = block.sectionPath || blockTitleText;

                    const galleryId = slugify(block.sectionPath || blockTitleText);
                    block.images.forEach((image) => {
                        grid.appendChild(buildCard(image, galleryId, blockTitleText));
                    });

                    blockEl.appendChild(blockTitleEl);
                    blockEl.appendChild(breadcrumbEl);
                    blockEl.appendChild(grid);
                    sectionEl.appendChild(blockEl);
                });

                sectionsEl.appendChild(sectionEl);
            });

            statusEl.hidden = true;
            sectionsEl.hidden = false;

            const lightbox = new PhotoSwipeLightbox({
                gallery: '.gallery-grid',
                children: 'a[data-pswp]',
                pswpModule: () => import('https://unpkg.com/photoswipe@5/dist/photoswipe.esm.js'),
            });
            lightbox.init();
        };

        const loadManifest = async () => {
            if (Array.isArray(window.SCREENSHOTS_MANIFEST)) {
                renderSections(window.SCREENSHOTS_MANIFEST);
                return;
            }

            try {
                const response = await fetch('assets/screenshots-manifest.json', { cache: 'no-store' });
                if (!response.ok) throw new Error(`Failed to load manifest: ${response.status}`);
                const manifest = await response.json();
                renderSections(manifest);
            } catch (error) {
                console.error(error);
                setStatus('Could not load screenshots. Ensure assets/screenshots-manifest.js or assets/screenshots-manifest.json is present.');
            }
        };

        loadManifest();
    </script>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="mailto:david@quynah.com" class="footer-link">Contact</a>
                    <a href="https://github.com/Quynah" class="footer-link" target="_blank" rel="noopener">GitHub</a>
                    <a href="index.html#privacy" class="footer-link">Privacy</a>
                </div>
                <p class="footer-copyright">© 2025 Quynah Security Platform — Evidence-Driven. Multi-Tenant. Local-First.</p>
            </div>
        </div>
    </footer>
</body>
</html>
